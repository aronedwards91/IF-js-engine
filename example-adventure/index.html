<!DOCTYPE html>
<head>
  <style>
    .show-text {
      margin: 2rem;
      padding: 1rem;
      border: 2px solid black;
      border-radius: 10px;
      max-height: 10rem;
      overflow-y: scroll;
    }
    #text-print {
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div class="show-text">
    <p id="text-print"></p>
  </div>
  <textarea id="textinput"></textarea>
  <p>hit Enter</p>
</body>
<script src="/index.js"></script>
<script defer>
  const textPrint = document.getElementById("text-print");
  const scroller = document.getElementsByClassName("show-text")[0];

  Promise.all(
    [
      "/info.json",
      "/items.json",
      "/rooms.json",
      "/states.json",
      "/triggers.json",
    ].map((request) => {
      return fetch(request)
        .then((response) => {
          return response.json();
        })
        .then((data) => {
          return data;
        });
    })
  )
    .then(([info, itemsData, roomsData, stateData, triggersData]) => {
      console.log("info", info);
      const Game = IFictionEngine.intialiseGameData({
        info,
        roomsData,
        itemsData,
        triggersData,
        stateData,
      });

      textPrint.innerHTML = textPrint.innerHTML + `<b>${Game.startTitle}</b>`;
      textPrint.innerHTML = textPrint.innerHTML + `<p>${Game.startString}</p>`;
    })
    .catch(console.error.bind(console));

  var wage = document.getElementById("textinput");
  wage.addEventListener("keydown", function (e) {
    if (e.code === "Enter") {
      //checks whether the pressed key is "Enter"
      validate(e);
    }
  });

  function validate(e) {
    var text = e.target.value;
    textPrint.innerHTML = textPrint.innerHTML + "</br>" + text;

    scroller.scrollIntoView(false);
    document.getElementById("textinput").value = "";
  }
</script>
